{"version":3,"sources":["../../src/components/search.js"],"names":[],"mappings":"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","file":"search.js","sourcesContent":["//Libraries\nconst React = require(\"react/addons\");\nconst _     = require(\"lodash\");\n\n\n//Flux\n// const DataStore      = require(\"../stores/data_store\");\nconst DataActions    = require(\"../actions/data_actions\");\nconst FilterActions  = require(\"../actions/filter_actions\");\nconst ColumnsActions = require(\"../actions/columns_actions\");\n\nconst ColumnsStore  = require(\"../stores/columns_store\");\nconst DataStore     = require(\"../stores/data_store\");\n// const FilterStore   = require(\"../stores/filter_store\");\n\n// Morse Libraies\nconst ViewportDetect = require(\"viewport-detection-es6\");\n\n\n//Components\nconst DataHead    =  require(\"./data_head\");\nconst Filters     =  require(\"./filters\");\nconst PaginationHolder  = require(\"./pagination\");\nconst ProgressBar = require(\"react-bootstrap/lib/ProgressBar.js\");\n\nclass Search extends React.Component{\n\n  constructor(props) {\n    super(props);\n    this.active = [{active:false}];\n    this.percent = 0;\n    this.state = {data:[], keys:[], visible:[], device:\"desktop\"};\n  }\n\n\n  componentDidMount() {\n    console.log(\"Search mounting\")\n    const detect = new ViewportDetect();\n    this.device = detect.getDevice();\n    this.size  = detect.windowSize();\n    let colsId = ColumnsActions.addingColumns(this.props.columns);\n    ColumnsActions.changeDevice(this.device);\n    this.setState({\n      // device:device,\n      loading:true,\n      loading_txt:\"Starting data load\",\n      percent: 0,\n      colsId:colsId\n    });\n    detect.trackSize(function(device, size){\n      if(this.device !== device){\n        this.device =  device;\n        ColumnsActions.changeDevice(device);\n\n      }\n\n      this.size   = size;\n\n    }.bind(this));\n\n    //Adds Keys\n    let keys = ColumnsStore.getSearchable();\n    FilterActions.setKeys(_.pluck(keys, \"key\"));\n\n    this.setLoading();\n    DataStore.addChangeListener(\"fetched\", this._onLoaded.bind(this));\n  }\n\n  componentWillUnmount() {\n    console.log(\"Search unmounting <<<<<<<<<<< WTF\")\n    DataStore.removeChangeListener(\"fetched\", this._onLoaded);\n  }\n\n\n  handleSelect(event, selectedEvent){\n    this.setState({\n      activePage: selectedEvent.eventKey\n    });\n  }\n\n  loading(){\n    if(this.state.loading){\n      return (\n        <div className=\"loader\">\n          <h5>{this.state.loading_txt}</h5>\n          <ProgressBar label=\"Loading Data\" now={this.state.percent} key={\"loader\"} />\n        </div>\n      );\n    } else {\n      return <PaginationHolder  key={\"pagination\"} />;\n    }\n  }\n\n  render() {\n    return (\n      <div>\n        <Filters filterApi={this.props.filterApi} date_ranges={this.props.date_ranges} key={\"filters\"} />\n        <DataHead device={this.state.device} keys={this.state.visible} css={this.props.css} key={_.uniqueId(\"samplehead\")} />\n\n        { this.props.children }\n        {this.loading()}\n\n      </div>\n    );\n  }\n\n  setLoading(){\n\n    let FakeLoading = window.setInterval(()=>{\n      if(this.percent < 50){\n        this.percent++;\n      }\n\n      this.setState({percent:this.percent, loading:true, loading_txt:\"Waiting for Server to respond\"});\n    }, 1000);\n\n    //Get Data\n    DataActions.fetchData((p)=>{\n      clearInterval(FakeLoading);\n      if(p.percent >= 100){\n        this.setState({loading:false, percent:p.percent});\n      } else {\n        this.percent = (this.percent > p.percent) ? this.percent : p.percent;\n        this.setState({percent:this.percent, loading_txt:\"Loading Data\"});\n      }\n    }, this.props.dataApi);\n  }\n\n  _onLoaded(){\n    // let items_count = DataStore.getAll();\n    this.setState({loading:false, percent:100});\n  }\n\n}\n\nmodule.exports = Search;\n"]}