{"version":3,"sources":["../../src/stores/tabs_store.js"],"names":[],"mappings":"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","file":"tabs_store.js","sourcesContent":["const EventEmitter  = require(\"events\").EventEmitter;\nconst assign        = require(\"react/lib/Object.assign\");\n\nconst _ = require(\"lodash\");\n\nconst textMixins = require(\"morse-react-mixins\").text_mixins;\nconst TabsDispatcher = require(\"../dispatcher/tabs_dispatcher\");\n\n\nconst registeredCallback = function(payload) {\n  let action = payload.action;\n  switch(action.type) {\n    case \"ADDING_TABS\":\n      TabsStore.addTabs(action.tabs, action.id);\n      TabsStore.emitChange(\"adding\");\n      break;\n\n    case \"CHANGE_DEVICE\":\n      TabsStore.changeDevice(action.device);\n      TabsStore.emitChange(\"change\");\n      break;\n    }\n};\n\nconst store = {\n  device       : \"mobile\",\n  tabs         : [],\n  tabs_ids     : [],\n  visible_tabs : [],\n\n\n  emitChange(event) {\n    this.emit(event);\n  },\n\n  addChangeListener(event, callback) {\n    this.on(event, callback);\n  },\n\n  removeChangeListener(event, callback) {\n    this.removeListener(event, callback);\n  },\n\n  addTabs(t, id){\n    id   = id || _.uniqueId();\n    let tabs = this.setTitles(t);\n    this.tabs.push({id:id, tabs:tabs});\n\n    return id;\n  },\n\n  changeDevice(d){\n    this.device = d;\n    // this.tabs = _.map(this.tabs, (tab)=>{\n    //   tab.visible = this.setVisibleTabs(tab.tabs);\n    //   return tab;\n    // });\n\n  },\n\n  getTab(id){\n    let items;\n    if(id){\n      items =  _.find(this.tabs, (tab)=>{\n        return tab.id === id;\n      });\n    } else {\n      items = _.first(this.tabs);\n    }\n\n    if(items){\n      return items;\n    }\n\n    return {tabs:[]};\n  },\n\n\n\n  // getTitles(id){\n  //   let visible = this.getTab(id).visible;\n  //   return _.pluck(visible, \"title\");\n  // },\n\n  // getTitleForKey(key, id){\n  //   let tabumn = this.getTab(id).tabs;\n  //   let item = _.find(tabumn, (tab)=> tab.key === key );\n  //   return item.title;\n  // },\n\n\n  // reduceObj(obj, values){\n  //   let reduced = _.omit(obj, (v, k)=>{\n  //     return !_.includes(values, k);\n  //   });\n  //   return reduced;\n  // },\n\n\n  setTitles(tabs){\n    tabs = _.map(tabs, function(tab){\n      // console.log(that.capitalize)\n      if(!_.has(tab, \"title\")){\n        let title = this.capitalize(tab.key);\n        _.set(tab, \"title\", title);\n      }\n\n      return tab;\n    }.bind(this));\n\n    return tabs;\n  }\n};\n\nObject.assign(store, textMixins);\n\n\nconst TabsStore = assign({}, EventEmitter.prototype, store);\n\nTabsStore.dispatchToken = TabsDispatcher.register(registeredCallback);\nTabsStore.setMaxListeners(0);\n\nmodule.exports = TabsStore;\n"]}