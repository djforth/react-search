{"version":3,"sources":["../../src/factories/data_fcty.js"],"names":[],"mappings":";;;;;;;;;;AACA,IAAM,CAAC,GAAa,OAAO,CAAC,QAAQ,CAAC,CAAC;AACtC,IAAM,WAAW,GAAG,OAAO,CAAC,aAAa,CAAC,CAAC;;IAErC,QAAQ;YAAR,QAAQ;;WAAR,QAAQ;0BAAR,QAAQ;;+BAAR,QAAQ;;;eAAR,QAAQ;;WAER,gBAAE;AACJ,UAAI,CAAC,KAAK,GAAG,EAAE,CAAC;AAChB,UAAI,CAAC,UAAU,GAAG,EAAE,CAAC;AACrB,UAAI,CAAC,IAAI,GAAS,CAAC,CAAC;AACpB,UAAI,CAAC,MAAM,GAAO,CAAC,CAAC;AACpB,UAAI,CAAC,cAAc,GAAG,IAAI,CAAC;KAC5B;;;WAEW,sBAAC,CAAC,EAAC;AACb,UAAG,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,EAAC;AACd,eAAO,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;OACtB,MAAM;AACL,eAAO,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;OACtB;KACF;;;WAEU,qBAAC,GAAG,EAAC;AACd,UAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,EAAC;AACxB,YAAI,CAAC,YAAY,EAAE,CAAC;AACpB,YAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,UAAC,CAAC,EAAG;AAC7B,cAAI,QAAQ,GAAG,KAAK,CAAC;AACrB,cAAI,EAAE,GAAG,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;AACrB,cAAG,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,EAAC;AAChB,oBAAQ,GAAG,CAAC,CAAC,QAAQ,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC;WAChC,MAAM;AACL,oBAAQ,GAAG,GAAG,KAAK,EAAE,CAAC;WACvB;;AAED,WAAC,GAAG,CAAC,CAAC,GAAG,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAC;AAChC,iBAAO,CAAC,CAAC;SACV,CAAC,CAAC;OACJ;KAEF;;;WAEK,gBAAC,GAAG,EAAC;AACT,UAAI,CAAC,GAAG,GAAG,GAAG,CAAC;KAChB;;;WAEoB,+BAAC,UAAU,EAAC;AAC/B,UAAI,KAAK,GAAG,IAAI,CAAC,kBAAkB,CAAC,UAAU,EAAE,YAAY,CAAC,CAAC;;AAE9D,UAAG,CAAC,CAAC,SAAS,CAAC,KAAK,CAAC,EAAC;AACpB,eAAO,KAAK,CAAC;OACd;;AAED,WAAK,GAAG,IAAI,CAAC;AACb,UAAI,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC;;AAEpC,OAAC,CAAC,KAAK,CAAC,UAAU,EAAE,UAAC,CAAC,EAAE,CAAC,EAAG;AAC1B,YAAI,EAAE,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC;;AAEpB,YAAG,CAAC,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,IAAI,CAAC,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,EAAC;AAClC,eAAK,GAAG,KAAK,CAAC;AACd,iBAAO,KAAK,CAAC;SACd;OACF,CAAC,CAAC;;AAEH,aAAO,KAAK,CAAC;KACd;;;WAEgB,2BAAC,OAAO,EAAC;;;AAExB,UAAI,KAAK,GAAG,IAAI,CAAC,kBAAkB,CAAC,OAAO,EAAE,SAAS,CAAC,CAAC;;AAExD,UAAG,CAAC,CAAC,SAAS,CAAC,KAAK,CAAC,EAAC;AACpB,eAAO,KAAK,CAAC;OACd;;AAED,WAAK,GAAG,IAAI,CAAC;AACb,OAAC,CAAC,OAAO,CAAC,OAAO,EAAE,UAAC,CAAC,EAAG;AACtB,YAAI,MAAM,GAAG,MAAK,cAAc,CAAC,WAAW,EAAE,CAAC,CAAC,SAAS,CAAC,CAAC;;AAE3D,YAAG,CAAC,CAAC,CAAC,QAAQ,CAAC,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,EAAC;AACrC,eAAK,GAAG,KAAK,CAAC;AACd,iBAAO,KAAK,CAAC;SACd;OACF,CAAC,CAAC;;AAEH,aAAO,KAAK,CAAC;KACd;;;WAGa,wBAAC,GAAG,EAAE,IAAI,EAAC;AACvB,UAAI,SAAS,GAAG,IAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;AACtD,UAAI,CAAC,CAAC,SAAS,CAAC,SAAS,CAAC,EAAC;AACzB,eAAO,SAAS,CAAC;OAClB;;AAED,UAAG,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,EAAC;AAClB,eAAO,KAAK,CAAC;OACd;;;AAGD,aAAQ,IAAI,CAAC,KAAK,CAAC,IAAI,KAAK,GAAG,IAAK,CAAC,CAAC,UAAU,CAAC,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,MAAM,KAAK,CAAC,AAAC,CAAC;KACvF;;;WAES,oBAAC,IAAI,EAAE,KAAK,EAAC;AACrB,UAAI,IAAI,GAAG,KAAK,CAAC;;AAEjB,UAAG,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,EAAC;;AAEhB,YAAG,AAAC,IAAI,GAAG,KAAK,CAAC,EAAE,IAAM,IAAI,GAAG,KAAK,CAAC,EAAE,AAAC,EAAC;AACxC,cAAI,GAAG,IAAI,CAAC;SACb;OACF;;AAED,aAAO,IAAI,CAAC;KAEb;;;WAEiB,4BAAC,KAAK,EAAE,GAAG,EAAC;AAC5B,UAAG,CAAC,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,EAAC;AAC5B,eAAO,IAAI,CAAC;OACb;;AAED,UAAG,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,EAAC;AAClB,eAAO,KAAK,CAAC;OACd;;AAED,aAAO,IAAI,CAAC;KACb;;;WAIW,sBAAC,IAAI,EAAE,MAAM,EAAC;;AAExB,UAAI,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;AAC5C,UAAI,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;;AAErC,aAAO,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC;KAErC;;;WAEO,kBAAC,QAAQ,EAAE,GAAG,EAAC;AACrB,UAAG,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,EAAC;AAChB,YAAG,CAAC,CAAC,YAAY,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC,MAAM,GAAG,CAAC,EAAC;AAC1C,iBAAO,IAAI,CAAC;SACb;OACF,MAAM,IAAG,CAAC,CAAC,OAAO,CAAC,QAAQ,EAAE,GAAG,CAAC,EAAC;AACjC,eAAO,IAAI,CAAC;OACb;;AAED,aAAO,KAAK,CAAC;KACd;;;WAGc,yBAAC,MAAM,EAAE,UAAU,EAAC;;;AACjC,UAAI,CAAC,KAAK,CAAC,UAAU,GAAS,CAAC,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;AACtD,UAAG,CAAC,CAAC,CAAC,OAAO,CAAC,UAAU,CAAC,EAAC;AACxB,cAAM,GAAG,MAAM,CAAC,MAAM,CAAC,UAAC,CAAC,EAAG;AAC1B,cAAI,OAAO,GAAG,KAAK,CAAC;AACpB,WAAC,CAAC,KAAK,CAAC,UAAU,EAAE,UAAC,EAAE,EAAE,GAAG,EAAG;AAC7B,gBAAG,OAAK,UAAU,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAC;AACjC,qBAAO,GAAG,IAAI,CAAC;AACf,qBAAO,KAAK,CAAC;aACd;WACF,CAAC,CAAC;;AAEH,iBAAO,OAAO,CAAC;SAChB,CAAC,CAAC;OACJ;;AAED,UAAI,CAAC,KAAK,CAAC,gBAAgB,GAAG,MAAM,CAAC;AACrC,aAAO,MAAM,CAAC;KACf;;;WAIW,sBAAC,MAAM,EAAE,OAAO,EAAC;;;AAC3B,UAAI,CAAC,KAAK,CAAC,OAAO,GAAG,OAAO,CAAC;;AAE7B,aAAO,GAAG,CAAC,CAAC,KAAK,CAAC,OAAO,EAAE,EAAC,GAAG,EAAC,KAAK,EAAC,CAAC,CAAC;;;AAGxC,UAAG,OAAO,CAAC,MAAM,GAAG,CAAC,EAAC;AACpB,cAAM,GAAG,MAAM,CAAC,MAAM,CAAC,UAAC,CAAC,EAAG;AAC1B,cAAI,OAAO,GAAG,KAAK,CAAC;AACpB,WAAC,CAAC,OAAO,CAAC,OAAO,EAAE,UAAC,MAAM,EAAG;AAC3B,gBAAG,OAAK,YAAY,CAAC,CAAC,CAAC,GAAG,CAAC,SAAS,CAAC,EAAE,MAAM,CAAC,EAAC;AAC7C,qBAAO,GAAG,IAAI,CAAC;AACf,qBAAO,KAAK,CAAC;aACd;WACF,CAAC,CAAC;;AAEH,iBAAO,OAAO,CAAC;SAChB,CAAC,CAAC;OACJ;;AAED,UAAI,CAAC,KAAK,CAAC,YAAY,GAAG,MAAM,CAAC;AACjC,aAAO,MAAM,CAAC;KACf;;;WAEU,qBAAC,GAAG,EAAC;AACd,UAAG,IAAI,CAAC,IAAI,EAAC;AACX,eAAO,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,UAAC,CAAC,EAAG;;AAE3B,iBAAO,CAAC,CAAC,QAAQ,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;SAC7C,CAAC,CAAC;OACJ;AACD,aAAO,IAAI,CAAC;KACb;;;WAEa,wBAAC,GAAG,EAAE,OAAO,EAAC;AAC1B,aAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,UAAC,CAAC,EAAG;AACrC,eAAO,CAAC,CAAC,GAAG,CAAC,KAAK,OAAO,CAAC;OAC3B,CAAC,CAAC;KACJ;;;WAEK,gBAAC,QAAQ,EAAC;AACd,UAAI,GAAG,GAAG,QAAQ,CAAC,GAAG,CAAC,UAAC,CAAC,EAAG;AAC1B,eAAO,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;OACpB,CAAC,CAAC;;AAEH,aAAO,GAAG,CAAC,IAAI,EAAE,CAAC;KACnB;;;WAEQ,mBAAC,IAAI,EAAE,GAAG,EAAE,IAAI,EAAC;;;;AAExB,UAAI,KAAK,GAAG,IAAI,MAAM,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;AACjC,UAAI,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,CAAA,UAAC,CAAC,EAAG;AAC5B,eAAO,OAAK,SAAS,CAAC,KAAK,EAAE,CAAC,EAAE,IAAI,CAAC,CAAC;OACvC,CAAA,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;;AAEd,UAAI,CAAC,KAAK,CAAC,IAAI,GAAK,GAAG,CAAC;AACxB,UAAI,CAAC,KAAK,CAAC,IAAI,GAAK,IAAI,CAAC;AACzB,UAAI,CAAC,KAAK,CAAC,MAAM,GAAG,MAAM,CAAC;;AAE3B,aAAO,MAAM,CAAC;KACf;;;WAEQ,mBAAC,IAAI,EAAE,IAAI,EAAC;AACnB,UAAG,IAAI,CAAC,MAAM,GAAG,CAAC,EAAC;AACjB,YAAI,GAAG,GAAG,IAAI,CAAC,MAAM,CAAC,UAAC,CAAC,EAAE,CAAC,EAAG;AAC5B,iBAAO,CAAC,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;SAC5B,CAAC,CAAC;AACH,eAAO,GAAG,CAAC,QAAQ,EAAE,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;OACxC,MAAM;AACL,YAAI,CAAC,GAAG,AAAC,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,GAAI,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC;AACjD,eAAO,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;OACpB;KACF;;;WAEQ,mBAAC,KAAK,EAAE,IAAI,EAAE,IAAI,EAAC;;AAE1B,UAAI,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;;AAExC,UAAG,MAAM,EAAC;AACR,eAAQ,MAAM,CAAC,MAAM,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAE;OAC5C;;AAED,aAAO,KAAK,CAAC;KACd;;;WAEK,kBAAS;wCAAL,IAAI;AAAJ,YAAI;;;AACZ,UAAI,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;;;AAG9C,UAAI,SAAS,GAAI,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,IAAI,EAAE,MAAM,CAAC,IAAI,CAAC,CAAC;AAC/D,UAAI,UAAU,GAAG,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;AACxD,UAAI,QAAQ,GAAK,IAAI,CAAC,qBAAqB,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;;AAE/D,UAAG,SAAS,IAAI,UAAU,IAAI,QAAQ,EAAC;AACrC,eAAO,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC;OAC9B;AACD,UAAI,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC;;AAEvB,UAAG,CAAC,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,OAAO,CAAC,EAAC;AAC5B,cAAM,GAAG,AAAC,UAAU,GAAI,IAAI,CAAC,KAAK,CAAC,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,MAAM,CAAC,OAAO,CAAC,CAAC;OAC7F;;;AAGD,UAAG,CAAC,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,UAAU,CAAC,EAAC;AAC/B,cAAM,GAAG,AAAC,UAAU,IAAI,QAAQ,GAAI,IAAI,CAAC,KAAK,CAAC,gBAAgB,GAAG,IAAI,CAAC,eAAe,CAAC,MAAM,EAAE,MAAM,CAAC,UAAU,CAAC,CAAC;OACnH;;;AAGD,UAAG,CAAC,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,EAAC;AACzB,cAAM,GAAI,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE,MAAM,CAAC,IAAI,EAAE,MAAM,CAAC,IAAI,CAAC,CAAC;OAC5D;;AAED,UAAI,CAAC,KAAK,CAAC,UAAU,GAAG,MAAM,CAAC;AAC/B,aAAO,MAAM,CAAC;KAEf;;;WAEQ,qBAAS;AAChB,UAAI,MAAM,GAAG,EAAE,CAAC;;yCADL,IAAI;AAAJ,YAAI;;;AAEd,OAAC,CAAC,OAAO,CAAC,IAAI,EAAE,UAAC,GAAG,EAAG;AACtB,YAAG,CAAC,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAC;AACjB,gBAAM,CAAC,IAAI,GAAG,GAAG,CAAC;SACnB;;AAED,YAAG,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,EAAC;AAChB,cAAI,GAAG,GAAG,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;AACvB,cAAI,CAAC,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;AACnB,kBAAM,CAAC,IAAI,GAAG,GAAG,CAAC;WACnB;;AAED,cAAI,CAAC,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;AACnB,kBAAM,CAAC,OAAO,GAAG,GAAG,CAAC;WACtB;SACF;;AAED,YAAI,CAAC,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,EAAC;AACrC,gBAAM,CAAC,UAAU,GAAG,GAAG,CAAC;SACzB;OACF,CAAC,CAAC;AACH,OAAC,CAAC,QAAQ,CAAC,MAAM,EACf,EAAE,MAAM,EAAE,EAAE,EAAE,EACd,EAAE,MAAM,EAAE,EAAE,EAAE,EACd,EAAE,SAAS,EAAE,EAAE,EAAE,EACjB,EAAE,YAAY,EAAC,EAAE,EAAE,CAAC,CAAC;AACvB,aAAO,MAAM,CAAC;KACf;;;SA5TG,QAAQ;GAAS,WAAW;;AA+TlC,MAAM,CAAC,OAAO,GAAG,QAAQ,CAAC","file":"data_fcty.js","sourcesContent":["\nconst _           = require(\"lodash\");\nconst DataManager = require(\"datamanager\");\n\nclass DataFcty extends DataManager {\n\n  init(){\n    this.cache = {};\n    this.pagination = 50;\n    this.page       = 1;\n    this.itemNo     = 0;\n    this.current_search = null;\n  }\n\n  checkDataIds(d){\n    if(_.isArray(d)){\n      return !_.isEmpty(d);\n    } else {\n      return _.isNumber(d);\n    }\n  }\n\n  addSelected(ids){\n    if(this.checkDataIds(ids)){\n      this.addToHistory();\n      this.data = this.data.map((d)=>{\n        let selected = false;\n        let id = d.get(\"id\");\n        if(_.isArray(ids)){\n          selected = _.contains(ids, id);\n        } else {\n          selected = ids === id;\n        }\n\n        d = d.set(\"selected\", selected);\n        return d;\n      });\n    }\n\n  }\n\n  setApi(uri){\n    this.url = uri;\n  }\n\n  checkCachedDateRanges(dateRanges){\n    let check = this.checkEmptyOrCached(dateRanges, \"dateRanges\");\n\n    if(_.isBoolean(check)){\n      return check;\n    }\n\n    check = true;\n    let cacheDR = this.cache.dateRanges;\n\n    _.forIn(dateRanges, (v, k)=>{\n      let dr = cacheDR[k];\n\n      if(v.st !== dr.st || v.fn !== dr.fn){\n        check = false;\n        return false;\n      }\n    });\n\n    return check;\n  }\n\n  checkCacheFilters(filters){\n\n    let check = this.checkEmptyOrCached(filters, \"filters\");\n\n    if(_.isBoolean(check)){\n      return check;\n    }\n\n    check = true;\n    _.forEach(filters, (f)=>{\n      let cached = this.getFilterByKey(\"filter_by\", f.filter_by);\n\n      if(!f.selected.equals(cached.selected)){\n        check = false;\n        return false;\n      }\n    });\n\n    return check;\n  }\n\n\n  checkCacheText(val, keys){\n    let checkKeys = this.checkEmptyOrCached(keys, \"keys\");\n    if (_.isBoolean(checkKeys)){\n      return checkKeys;\n    }\n\n    if(!this.cache.text){\n      return false;\n    }\n\n    // console.log(this.cache)\n    return  this.cache.text === val && (_.difference(keys, this.cache.keys).length === 0);\n  }\n\n  checkDates(date, range){\n    let test = false;\n    // console.log(date, range)\n    if(_.isDate(date)){\n      // console.log((date > range.st), (date < range.fn));\n      if((date > range.st) && (date < range.fn)){\n        test = true;\n      }\n    }\n\n    return test;\n\n  }\n\n  checkEmptyOrCached(items, key){\n    if(_.isEmpty(items) || !items){\n      return true;\n    }\n\n    if(!this.cache[key]){\n      return false;\n    }\n\n    return null;\n  }\n\n\n\n  checkFilters(opts, filter){\n\n    let selected = this.getIds(filter.selected);\n    let ids = opts.get(filter.filter_by);\n\n    return this.checkIds(selected, ids);\n\n  }\n\n  checkIds(selected, ids){\n    if(_.isArray(ids)){\n      if(_.intersection(selected, ids).length > 0){\n        return true;\n      }\n    } else if(_.include(selected, ids)){\n      return true;\n    }\n\n    return false;\n  }\n\n\n  dateRangeSearch(search, dateRanges){\n    this.cache.dateRanges       = _.cloneDeep(dateRanges);\n    if(!_.isEmpty(dateRanges)){\n      search = search.filter((d)=>{\n        let checked = false;\n        _.forIn(dateRanges, (dr, key)=>{\n          if(this.checkDates(d.get(key), dr)){\n            checked = true;\n            return false;\n          }\n        });\n\n        return checked;\n      });\n    }\n\n    this.cache.dateRangesSearch = search;\n    return search;\n  }\n\n\n\n  filterSearch(search, filters){\n    this.cache.filters = filters;\n\n    filters = _.where(filters, {all:false});\n    // let search = this.data;\n\n    if(filters.length > 0){\n      search = search.filter((d)=>{\n        let checked = false;\n        _.forEach(filters, (filter)=>{\n          if(this.checkFilters(d.get(\"filters\"), filter)){\n            checked = true;\n            return false;\n          }\n        });\n\n        return checked;\n      });\n    }\n\n    this.cache.filterSearch = search;\n    return search;\n  }\n\n  filterByIds(ids){\n    if(this.data){\n      return this.data.filter((d)=>{\n        // console.log(ids, d.get(\"id\"));\n        return _.contains(ids, Number(d.get(\"id\")));\n      });\n    }\n    return null;\n  }\n\n  getFilterByKey(key, keyComp){\n    return _.find(this.cache.filters, (c)=>{\n      return c[key] === keyComp;\n    });\n  }\n\n  getIds(selected){\n    let ids = selected.map((s)=>{\n      return s.get(\"id\");\n    });\n\n    return ids.toJS();\n  }\n\n  getSearch(data, val, keys){\n    //Do search\n    let regex = new RegExp(val, \"i\");\n    let search = data.filter((d)=>{\n      return this.searchTxt(regex, d, keys);\n    }.bind(this));\n\n    this.cache.text   = val;\n    this.cache.keys   = keys;\n    this.cache.search = search;\n\n    return search;\n  }\n\n  getValues(data, keys){\n    if(keys.length > 1){\n      let all = data.filter((v, k)=>{\n        return _.contains(keys, k);\n      });\n      return all.valueSeq().toJS().join(\" \");\n    } else {\n      let k = (_.isArray(keys)) ? _.first(keys) : keys;\n      return data.get(k);\n    }\n  }\n\n  searchTxt(regex, data, keys){\n    // console.log(\"keys\", keys)\n    let values = this.getValues(data, keys);\n    // console.log(\"values\", values)\n    if(values){\n      return (String(values).search(regex) > -1);\n    }\n\n    return false;\n  }\n\n  search(...args){\n    let values = this.setValues.apply(this, args);\n\n    //Cache Checks\n    let cachedTxt  = this.checkCacheText(values.text, values.keys);\n    let cachedFltr = this.checkCacheFilters(values.filters);\n    let cachedDR   = this.checkCachedDateRanges(values.dateRanges);\n\n    if(cachedTxt && cachedFltr && cachedDR){\n      return this.cache.fullSearch;\n    }\n    let search = this.data;\n    //Runs filters over data\n    if(!_.isEmpty(values.filters)){\n      search = (cachedFltr) ? this.cache.filterSearch : this.filterSearch(search, values.filters);\n    }\n\n    //Runs Date Range search\n    if(!_.isEmpty(values.dateRanges)){\n      search = (cachedFltr && cachedDR) ? this.cache.dateRangesSearch : this.dateRangeSearch(search, values.dateRanges);\n    }\n\n    //Runs Search over data\n    if(!_.isEmpty(values.text)){\n      search =  this.getSearch(search, values.text, values.keys);\n    }\n\n    this.cache.fullSearch = search; // Caches search\n    return search;\n\n  }\n\n  setValues(...args){\n    let values = {};\n     _.forEach(args, (arg)=>{\n      if(_.isString(arg)){\n        values.text = arg;\n      }\n\n      if(_.isArray(arg)){\n        let fst = _.first(arg);\n        if( _.isString(fst) ){\n          values.keys = arg;\n        }\n\n        if( _.isObject(fst) ){\n          values.filters = arg;\n        }\n      }\n\n      if( _.isObject(arg) && !_.isArray(arg)){\n        values.dateRanges = arg;\n      }\n    });\n    _.defaults(values,\n      { \"text\": \"\" },\n      { \"keys\": [] },\n      { \"filters\": [] },\n      { \"dateRanges\":{} });\n    return values;\n  }\n}\n\nmodule.exports = DataFcty;\n"]}